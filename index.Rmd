---
title: "Assignment 4"
author: "Lucas Fox, Cuong Pham Vu"
date: "2/21/2022"
output: html_document
---

[Annual Survey of Jails 2018](https://www.icpsr.umich.edu/web/NACJD/series/7/studies)

```{r}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(haven)
library(janitor)
library(srvyr)
```

## Assignment 4


```{r}
jail <- read_dta("37392-0001-Data.dta")

jail <- jail %>%
  janitor::clean_names()

jail_svy <- jail %>% 
  as_survey_design(weights = finalwt)

```

## Plot 1

You can also embed plots, for example:

```{r}
jail %>%
  group_by(state) %>%
  mutate(totblack = sum(black),
         statepop = sum(totpop),
         totwhite = sum(white),
         totadmis = sum(admis)) %>%
  mutate(statenames = case_when(
    state == 1 ~ "AL",
    state == 3 ~ "AZ",
    state == 4 ~ "AR",
    state == 5 ~ "CA",
    state == 6 ~ "CO",
    state == 7 ~ "CT",
    state == 8 ~ "DE",
    state == 9 ~ "DC",
    state == 10 ~ "FL",
    state == 11 ~ "GA",
    state == 13 ~ "ID",
    state == 14 ~ "IL",
    state == 15 ~ "IN",
    state == 16 ~ "IA",
    state == 17 ~ "KS",
    state == 18 ~ "KY",
    state == 19 ~ "LA",
    state == 20 ~ "ME",
    state == 21 ~ "MD",
    state == 22 ~ "MA",
    state == 23 ~ "MI",
    state == 24 ~ "MN",
    state == 25 ~ "MS",
    state == 26 ~ "MO",
    state == 27 ~ "MT",
    state == 28 ~ "NE",
    state == 29 ~ "NV",
    state == 30 ~ "NH",
    state == 31 ~ "NJ",
    state == 32 ~ "NM",
    state == 33 ~ "NY",
    state == 34 ~ "NC",
    state == 35 ~ "ND",
    state == 36 ~ "OH",
    state == 37  ~ "OK",
    state == 38 ~ "OR",
    state == 39 ~ "PA",
    state == 41 ~ "SC",
    state == 42 ~ "SD",
    state == 43 ~ "TN",
    state == 44 ~ "TX",
    state == 45 ~ "UT",
    state == 47 ~ "VA",
    state == 48 ~ "WA",
    state == 49 ~ "WV",
    state == 50 ~ "WI",
    state == 51 ~ "WY"
  )) %>%
  mutate(propblack = totblack/statepop) %>%
  ggplot(mapping = aes(x = statepop, y = propblack, label = statenames)) +
  geom_text(check_overlap = TRUE)


```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
